<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Absensi Online - SMK Jakarta Timur 1</title>
    <link rel="stylesheet" href="style.css">
    <link rel="stylesheet" href="dark-mode.css">
    <link rel="manifest" href="manifest.json">
    <link rel="icon" href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22>ðŸ“…</text></svg>">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
</head>
<body>
    <div class="container">
        <!-- Header -->
        <header class="header">
            <div class="header-left">
                <img src="https://via.placeholder.com/50x50/2c3e50/ffffff?text=SMK" alt="Logo SMK" class="logo">
                <div>
                    <h1>Sistem Absensi Online</h1>
                    <p class="subtitle">SMK Jakarta Timur 1</p>
                </div>
            </div>
            <div class="header-right">
                <button id="darkModeToggle" class="btn-icon" aria-label="Mode Gelap/Terang">
                    <i class="fas fa-moon"></i>
                </button>
                <div id="userInfo" class="user-info">
                    <span id="userName">Guest</span>
                    <div class="user-avatar">
                        <i class="fas fa-user"></i>
                    </div>
                </div>
            </div>
        </header>

        <!-- Main Content -->
        <main class="main-content">
            <!-- Login Section -->
            <section id="loginSection" class="login-section">
                <div class="login-card">
                    <h2>Login ke Sistem</h2>
                    <div class="role-selector">
                        <button class="role-btn active" data-role="siswa">Siswa</button>
                        <button class="role-btn" data-role="guru">Guru</button>
                        <button class="role-btn" data-role="admin">Admin</button>
                    </div>
                    
                    <form id="loginForm">
                        <div class="form-group">
                            <label for="nisn"><i class="fas fa-id-card"></i> NISN / NIP</label>
                            <input type="text" id="nisn" placeholder="Masukkan NISN/NIP" required>
                        </div>
                        
                        <div class="form-group">
                            <label for="password"><i class="fas fa-lock"></i> Password</label>
                            <input type="password" id="password" placeholder="Masukkan password" required>
                        </div>

                        <div class="form-group" id="kelasGroup" style="display: none;">
                            <label for="kelas"><i class="fas fa-graduation-cap"></i> Kelas</label>
                            <select id="kelas">
                                <option value="">Pilih Kelas</option>
                                <option value="X TKJ 1">X TKJ 1</option>
                                <option value="X TKJ 2">X TKJ 2</option>
                                <option value="XI TKJ 1">XI TKJ 1</option>
                                <option value="XII TKJ 1">XII TKJ 1</option>
                            </select>
                        </div>

                        <button type="submit" class="btn-login">
                            <i class="fas fa-sign-in-alt"></i> Masuk
                        </button>
                    </form>

                    <div class="login-footer">
                        <p>Belum punya akun? <a href="#" id="registerLink">Daftar di sini</a></p>
                        <p><a href="#" id="forgotPassword">Lupa password?</a></p>
                    </div>
                </div>
            </section>

            <!-- Dashboard Section (Hidden by default) -->
            <section id="dashboardSection" class="dashboard-section" style="display: none;">
                <!-- Student/Guru Dashboard -->
                <div id="userDashboard">
                    <div class="dashboard-header">
                        <h2>Selamat Datang, <span id="greetingName">User</span>!</h2>
                        <div class="date-time">
                            <span id="currentDate"></span>
                            <span id="currentTime"></span>
                        </div>
                    </div>

                    <!-- Quick Stats -->
                    <div class="quick-stats">
                        <div class="stat-card present">
                            <i class="fas fa-calendar-check"></i>
                            <h3 id="presentCount">0</h3>
                            <p>Hadir</p>
                        </div>
                        <div class="stat-card absent">
                            <i class="fas fa-calendar-times"></i>
                            <h3 id="absentCount">0</h3>
                            <p>Absen</p>
                        </div>
                        <div class="stat-card late">
                            <i class="fas fa-clock"></i>
                            <h3 id="lateCount">0</h3>
                            <p>Terlambat</p>
                        </div>
                        <div class="stat-card percentage">
                            <i class="fas fa-chart-line"></i>
                            <h3 id="attendancePercentage">0%</h3>
                            <p>Kehadiran</p>
                        </div>
                    </div>

                    <!-- Attendance Actions -->
                    <div class="attendance-card">
                        <h3><i class="fas fa-fingerprint"></i> Absensi Hari Ini</h3>
                        <div class="attendance-status">
                            <p id="todayStatus">Status: Belum absen</p>
                            <p id="attendanceTime">-</p>
                        </div>
                        
                        <div class="attendance-buttons">
                            <button id="checkInBtn" class="btn-attendance present">
                                <i class="fas fa-sign-in-alt"></i> Check In
                            </button>
                            <button id="checkOutBtn" class="btn-attendance primary" disabled>
                                <i class="fas fa-sign-out-alt"></i> Check Out
                            </button>
                            <button id="manualAttendanceBtn" class="btn-attendance secondary">
                                <i class="fas fa-edit"></i> Absen Manual
                            </button>
                        </div>

                        <!-- QR Scanner -->
                        <div class="qr-section">
                            <button id="toggleQrBtn" class="btn-qr">
                                <i class="fas fa-qrcode"></i> Scan QR Code
                            </button>
                            <div id="qrScanner" class="qr-scanner" style="display: none;">
                                <div id="qr-reader" style="width: 300px; margin: 0 auto;"></div>
                                <p class="qr-note">Arahkan kamera ke QR code yang disediakan</p>
                            </div>
                        </div>
                    </div>

                    <!-- Recent Attendance -->
                    <div class="recent-attendance">
                        <h3><i class="fas fa-history"></i> Riwayat Terbaru</h3>
                        <div id="attendanceHistory" class="attendance-list">
                            <!-- Data akan diisi oleh JavaScript -->
                        </div>
                    </div>
                </div>

                <!-- Admin Dashboard (Hidden by default) -->
                <div id="adminDashboard" style="display: none;">
                    <h2>Dashboard Admin</h2>
                    <div class="admin-controls">
                        <button class="btn-admin" onclick="showModal('manageUsers')">
                            <i class="fas fa-users"></i> Kelola Pengguna
                        </button>
                        <button class="btn-admin" onclick="showModal('reports')">
                            <i class="fas fa-file-export"></i> Generate Laporan
                        </button>
                        <button class="btn-admin" onclick="showModal('settings')">
                            <i class="fas fa-cog"></i> Pengaturan
                        </button>
                    </div>
                </div>
            </section>
        </main>

        <!-- Modals -->
        <div id="manualAttendanceModal" class="modal">
            <div class="modal-content">
                <span class="close-modal">&times;</span>
                <h3>Absen Manual</h3>
                <form id="manualAttendanceForm">
                    <div class="form-group">
                        <label>Jenis Kehadiran</label>
                        <select id="manualType">
                            <option value="hadir">Hadir</option>
                            <option value="sakit">Sakit</option>
                            <option value="izin">Izin</option>
                            <option value="alpha">Alpha</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label>Tanggal</label>
                        <input type="date" id="manualDate" required>
                    </div>
                    <div class="form-group">
                        <label>Keterangan</label>
                        <textarea id="manualNote" rows="3"></textarea>
                    </div>
                    <button type="submit" class="btn-primary">Simpan</button>
                </form>
            </div>
        </div>

        <!-- Notifications Container -->
        <div id="notificationsContainer" class="notifications-container"></div>

        <!-- Achievements Badge -->
        <div id="achievementsBadge" class="achievements-badge" style="display: none;">
            <i class="fas fa-trophy"></i>
            <span class="badge-count">0</span>
        </div>
    </div>

    <!-- Scripts -->
    <script src="https://unpkg.com/html5-qrcode"></script>
    <script src="script.js"></script>
    <script src="admin.js"></script>
    <script src="realtime.js"></script>
    <script src="dark-mode.js"></script>
    <script src="achievements.js"></script>
    <script src="notifications.js"></script>
    
    <!-- Service Worker Registration -->
    <script>
        if ('serviceWorker' in navigator) {
            navigator.serviceWorker.register('service-worker.js')
                .then(() => console.log('Service Worker terdaftar'))
                .catch(err => console.log('Service Worker gagal:', err));
        }
    </script>
</body>
    </html>
